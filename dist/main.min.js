/*! reactive-event-bus - v0.0.0 */
function forEach(a,b){for(var c=0,d=a.length;d>c;c++)b(a[c],c)}var bus={events:[],eventMap:{},run:function(){var a,b,c=this;setInterval(function(){c.events.length&&(b=c.events.shift(),Array.isArray(b)?(a=b.pop(),b=b.pop()):a=void 0,forEach(c.eventMap[b],function(b){var c=b[0],d=b[1];c(d,a)}))},5)},listen:function(a){Array.isArray(a.items)||(a.items=[a.items]),forEach(a.items,function(b){if("html"===a.type){var c="on"+a.name;b[c]=function(c){void 0!==c&&"stopPropagation"in c?(c.stopPropagation(),b.emit(a.name,c)):b.emit(a.name)}}else"object"===a.type})},add:function(a,b,c){void 0===this.eventMap[a]&&(this.eventMap[a]=[]),this.eventMap[a].push([c,b])},addEvent:function(a,b){this.events.push(void 0===b?a:[a,b])}};bus.run();var Emitter=function(a,b){this.events=[a],this.context=b,this.modulo=void 0,this.filterFn=void 0,this.data=void 0};Emitter.prototype.add=function(a){var b=this;if(void 0!==this.filterFn){var c=a;a=function(a,d){b.filterFn(a,d)&&c(a,d)}}forEach(this.events,function(c){if(void 0===b.modulo)bus.add(c,b.context,a);else{var d=0;bus.add(c,b.context,function(c,e){d++,d%b.modulo===0&&a(c,e)})}})},Emitter.prototype.emit=function(a,b){return bus.addEvent(a,b),this},Emitter.prototype.listen=function(a){return new Emitter(a,this.context)},Emitter.prototype.merge=function(a){return this.events.push(a),this},Emitter.prototype.run=function(a){return this.add(a),this},Emitter.prototype.interval=function(a){return this.modulo=a,this},Emitter.prototype.filter=function(a){return this.filterFn=a,this},Emitter.prototype.map=function(a){var b=this,c={then:function(c){return b.add(function(b,d){var e=a(b.context,d);b.data=e,c(e,b.context)}),b}};return c};var reactive=function(a){return a.listen=function(b){return new Emitter(b,a)},a.emit=function(a,b){bus.addEvent(a,b)},a};